<form [formGroup]="appointmentForm" (ngSubmit)="onSubmit()" class="appointment-form">
  <div class="appointment-info">
    <h4>Termin wizyty:</h4>
    <p>{{ formattedDate }}</p>
    <p>Maksymalny czas wizyty: {{ availableDuration }}</p>
  </div>

  <div class="form-group">
    <label for="patientName">Imię i nazwisko pacjenta</label>
    <input id="patientName" type="text" formControlName="patientName" class="form-control">
    <div class="error-message" *ngIf="appointmentForm.get('patientName')?.errors?.['required'] && appointmentForm.get('patientName')?.touched">
      Imię i nazwisko jest wymagane
    </div>
    <div class="error-message" *ngIf="appointmentForm.get('patientName')?.errors?.['minlength'] && appointmentForm.get('patientName')?.touched">
      Imię i nazwisko musi mieć co najmniej 3 znaki
    </div>
  </div>

  <div class="form-group">
    <label for="patientAge">Wiek pacjenta</label>
    <input id="patientAge" type="number" formControlName="patientAge" class="form-control">
    <div class="error-message" *ngIf="appointmentForm.get('patientAge')?.errors?.['required'] && appointmentForm.get('patientAge')?.touched">
      Wiek jest wymagany
    </div>
    <div class="error-message" *ngIf="appointmentForm.get('patientAge')?.errors?.['min'] || appointmentForm.get('patientAge')?.errors?.['max']">
      Wiek musi być między 0 a 150 lat
    </div>
  </div>

  <div class="form-group">
    <label for="patientGender">Płeć pacjenta</label>
    <select id="patientGender" formControlName="patientGender" class="form-control">
      <option value="">Wybierz płeć</option>
      <option value="M">Mężczyzna</option>
      <option value="F">Kobieta</option>
      <option value="O">Inna</option>
    </select>
    <div class="error-message" *ngIf="appointmentForm.get('patientGender')?.errors?.['required'] && appointmentForm.get('patientGender')?.touched">
      Płeć jest wymagana
    </div>
  </div>

  <div class="form-group">
    <label for="consultationType">Typ wizyty</label>
    <select id="consultationType" formControlName="consultationType" class="form-control">
      <option *ngFor="let type of consultationTypes" [value]="type">
        {{ type }}
      </option>
    </select>
  </div>

  <div class="form-group">
    <label for="duration">Czas trwania (minuty)</label>
    <select id="duration" formControlName="duration" class="form-control">
      <option *ngFor="let duration of [30, 60, 90, 120, 150, 180]" 
              [value]="duration"
              [disabled]="duration > maxDuration">
        {{ duration }} minut
      </option>
    </select>
    <div class="error-message" *ngIf="appointmentForm.get('duration')?.errors?.['max']">
      Maksymalny dostępny czas to {{ maxDuration }} minut
    </div>
  </div>

  <div class="form-group">
    <label for="notes">Dodatkowe uwagi</label>
    <textarea id="notes" formControlName="notes" class="form-control" rows="3"></textarea>
  </div>

  <div class="form-actions">
    <button type="submit" class="btn btn-primary" [disabled]="!appointmentForm.valid">
      Umów wizytę
    </button>
    <button type="button" class="btn btn-secondary" (click)="onCancel()">
      Anuluj
    </button>
  </div>
</form>
